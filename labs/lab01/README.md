# Планирование адресного пространства. IPv4

#### Цель:
В данной самостоятельной работе необходимо распланировать адресное пространство.<br>
Настроить IP на всех активных портах для дальнейшей работы над проектом.<br>
Адресное пространство должно быть задокументировано.<br>

#### Описание/Пошаговая инструкция выполнения домашнего задания:

В этой самостоятельной работе мы ожидаем, что вы самостоятельно:

1) Разработаете и задокументируете адресное пространство для лабораторного стенда.
2) Настроите IP адреса на каждом активном порту.
3) Настроите каждый VPC в каждом офисе в своем VLAN.
4) Настроите VLAN/Loopbackup interface управления для сетевых устройств. 
5) Настроите сети офисов так, чтобы не возникало broadcast штормов, а использование линков было максимально оптимизировано.
6) Используете IPv4. IPv6 по желанию.
 


### Принципы назначения IP адресов

### Выдача IPv4 адресов 

Принципы выделения IPv4-адресов:
- для организации внутренней связности выдаем адреса из приватной сети `10.0.0.0/8`
- Management/Loopback адреса коммутаторов/роутеров из `172.16.0.0/12`
- последний октет адреса совпадает с номером устройства на схеме.  
предпоследний октет, по возможности, выбирается из номеров интерфейсов устройств линка.  Например для линка `R12 e0/2-e0/0 R14` будем выбирать номер предпоследнего октета из {0, 2}.  
Условие выбора - отсутствие конфликтов с другими IP.
- белые адреса выбираются похожими на номер AS, в которой они используются.
Например, провайдеры из Триады (AS `520`) выдают клиентам сети с первым октетом `52` (`52.0.0.24`).
- подсеть `192.168.0.0/16` буду использовать по мере необходимости далее. 




## Таблицы IP адресов

Далее распишем IP адреса по офисам.

### Москва (AS1001)

Большой и старый офис.

Реализована 3-х уровневая модель:
- Core layer – R14, R15  
- Distribution layer – SW4, SW5, R12, R13  
- Access layer – SW2, SW3, VPC1, VPC7  




|Device|Port|IPv4      |VLAN|Link              |Comment           |
|------|----|----------|----|------------------|------------------|
|VPC1  |eth0|10.0.0.1/25 |-   |VPC1 eth0 - e0/2 SW3| Sales         
|VPC7  |eth0|10.0.1.7/25 |-   |VPC7 eth0 - e0/2 SW2| Legal         |
|SW2   |    |172.16.0.2/28|1000|                  |Management (VLAN)  |
|SW2   |e0/2|-         |102 |SW2 e0/2 - eth0 VPC7|Sales (VLAN)|
|SW3   |    |172.16.0.3/28|1000|                  |Management (VLAN)  |
|SW3   |e0/2|-         |101 |SW3 e0/2 - eth0 VPC1|Legal (VLAN)     |
|SW4   |    |172.16.0.4/28|1000|                  |Management (VLAN)  |
|SW5   |    |172.16.0.5/28|1000|                  |Management (VLAN)  |
|R12   |e0/0|10.0.0.12/25 |- |R12 e0/0 - e1/0 SW4|Connectivity to VPC1|
|R12   |e0/1|- |- |R12 e0/1 - e1/1 SW5|Robustness      |
|R12   |e0/2|10.0.2.12/28 |ptp   |R12 e0/2 - e0/0 R14|Connectivity      |
|R12   |e0/3|10.0.3.12/28 |ptp   |R12 e0/3 - e0/1 R15|Robustness        |
|R12   |-|172.16.2.12/32 |-   |-|Loopback                               |
|R13   |e0/0|10.0.1.13/28 |-   |R13 e0/0 - e1/0 SW5|Connectivity to VPC7|
|R13   |e0/1|- |-   |R13 e0/1 - e1/1 SW4|Robustness        |
|R13   |e0/2|10.0.4.13/28 |ptp   |R13 e0/2 - e0/0 R15|Connectivity      |
|R13   |e0/3|10.0.5.13/28 |ptp   |R13 e0/3 - e0/1 R14|Robustness        |
|R13   |-|172.16.2.13/32 |-   |-|Loopback                               |
|R14   |e0/0|10.0.2.14/28 |ptp   |R14 e0/0 - e0/2 R12|Connectivity      |
|R14   |e0/1|10.0.5.14/28 |ptp   |R14 e0/1 - e0/3 R13|Robustness        |
|R14   |e0/2|101.0.0.14/30|ptp   |R14 e0/2 - e0/0 R22|BGP: Provider link|
|R14   |e0/3|10.0.6.14/28 |ptp   |R14 e0/3 - e0/0 R19|Default (OSPF)    |
|R14   |-|172.16.2.14/32 |-   |-|Loopback                               |
|R15   |e0/0|10.0.4.15/28 |ptp   |R15 e0/0 - e0/2 R13|Connectivity      |
|R15   |e0/1|10.0.3.15/28 |ptp   |R15 e0/1 - e0/3 R12|Robustness        |
|R15   |e0/2|30.0.0.15/30 |ptp   |R15 e0/2 - e0/0 R21|BGP: Provider link|
|R15   |e0/3|10.0.7.15/28 |ptp   |R15 e0/3 - e0/0 R20|Default (OSPF)    |
|R15   |-|172.16.2.15/32 |-   |-|Loopback                               |
|R19   |e0/0|10.0.6.19/28 |ptp   |R19 e0/0 - e0/3 R14|Default (OSPF)    |
|R19   |-|172.16.2.19/32 |-   |-|Loopback                               |
|R20   |e0/0|10.0.7.20/28 |ptp   |R20 e0/0 - e0/3 R15|Default (OSPF)    |
|R20   |-|172.16.2.20/32 |-   |-|Loopback                               |



### Питер (AS2042)

Современный офис.  


|Device|Port|IPv4      |VLAN|Link              |Comment           |
|------|----|----------|----|------------------|------------------|
|VPC8  |eth0|10.1.0.8/25 |-  |VPC8 eth0 – e0/2 SW9|     Developers|
|VPC11 |eth0|10.1.1.11/25|- |VPC11 eth0 – e0/2 SW10|      Finance|
|SW9   |vlan if  |172.16.1.9/28|1000|                  |Managemen|
|SW9   |e0/2|- |80|SW9 to VPC8 |Developers (VLAN) |
|SW9   |    |-  |-   |SW9 e0/3 - e0/0 R17|End Users         |
|SW10  |vlan if    |172.16.1.10/28|1000||Management ||
|SW10  |e0/2|- |90 |SW10 to VPC11|Finance (VLAN)      |
|SW10  |    |- |-   |SW10 e0/3-e0/0 R16|End Users         |
|R16   |e0/0|10.1.1.16/25 |ptp   |R16 e0/0 – e0/3 SW10|Connectivity      |
|R16   |e0/1|10.1.2.16/27 |-   |R16 e0/1 – e0/0 R18|Connectivity      |
|R16   |e0/2|- |-   |R16 e0/2 – e1/0 SW9|Robustness        |
|R16   |e0/3|10.1.3.16/27 |-   |R16 e0/3 – e0/0 R32|Default (EIGRP)   |
|R16   |-|172.16.2.16/32 |-   |-|Loopback                               |
|R17   |e0/0|10.1.0.17/25 |-   |R17 e0/0 – e0/3 SW9|Connectivity      |
|R17   |e0/1|10.1.4.17/27 |-   |R17 e0/1 – e0/1 R18|Connectivity      |
|R17   |e0/2|- |-   |R17 e0/2 – e1/0 SW10|Robustness        |
|R17   |-|172.16.2.17/32 |-   |-|Loopback                               |
|R18   |e0/0|10.1.2.18/27 |-   |R18 e0/0 – e0/1 R16|Connectivity      |
|R18   |e0/1|10.1.4.18/27 |-   |R18 e0/1 – e0/1 R17|Connectivity      |
|R18   |e0/2|52.0.1.18/30 |-   |R18 e0/2 – e0/3 R24|BGP: Provider link|
|R18   |e0/3|52.0.1.25/30 |-   |R18 e0/3 – e0/3 R26|BGP: Provider link|
|R18   |-|172.16.2.18/32 |-   |-|Loopback                               |
|R32   |e0/0|10.1.3.32/27 |-   |R32 e0/0 – e0/3 R16|Default (EIGRP)   |
|R18   |-|172.16.2.18/32 |-   |-|Loopback                               |

### Ламас (AS301)

Московский провайдер  
Между Ламас и Киторн – серый пиринговый стык.  

|Device|Port|IPv4      |VLAN|Link              |Comment           |
|------|----|----------|----|------------------|------------------|
|R21        |e0/0|30.0.0.14/30 |-   |R21 e0/0 – e0/2 R15|BGP: Customer link|
|R21        |e0/1|192.168.0.21/30|-   |R21 e0/1 – e0/1 R22|BGP: Peering link|
|R21        |e0/2|52.0.0.25/30 |-   |R21 e0/2 – e0/0 R24|BGP: Provider link|
|R21   |-|172.16.2.21/32 |-   |-|Loopback                               |


### Киторн (AS101)

Московский провайдер

|Device|Port|IPv4      |VLAN|Link              |Comment           |
|------|----|----------|----|------------------|------------------|
|R22        |e0/0|101.0.0.13/30|-   |R22 e0/0 – e0/2 R14|BGP: Customer link|
|R22        |e0/1|192.168.0.22/30|-   |R22 e0/1 – e0/1 R21|BGP: Peering link |
|R22        |e0/2|52.0.0.22/30 |-   |R22 e0/2 – e0/0 R23|BGP: Provider link|
|R22   |-|172.16.2.22/32 |-   |-|Loopback                               |


### Триада (520)

"Ядро" Интернета

|Device|Port|IPv4      |VLAN|Link              |Comment           |
|------|----|----------|----|------------------|------------------|
|R23        |e0/0|52.0.0.23/30 |-   |R23 e0/0 – e0/2 R22|BGP: Customer link|
|R23        |e0/1|10.0.5.23/28 |-   |R23 e0/1 – e0/0 R25|Connectivity      |
|R23        |e0/2|10.1.5.23/28 |-   |R23 e0/2 – e0/2 R24|Connectivity      |
|R23   |-|172.16.2.23/32 |-   |-|Loopback                                  |
|R24        |e0/0|52.0.0.26/30 |-   |R24 e0/0 – e0/2 R21|BGP: Customer link|
|R24        |e0/1|10.0.3.25/29 |-   |R24 e0/1 – e0/0 R26|Connectivity      |
|R24        |e0/2|10.1.5.24/28 |-   |R24 e0/2 – e0/2 R23|Connectivity      |
|R24        |e0/3|52.0.1.17/30 |-   |R24 e0/3 – e0/2 R18|BGP: Customer link|
|R24   |-|172.16.2.24/32 |-   |-|Loopback                                  |
|R25        |e0/0|10.0.5.25/28 |-   |R25 e0/0 – e0/1 R23|Connectivity      |
|R25        |e0/1|52.0.1.37/30 |-   |R25 e0/1 – e0/0 R27|BGP: Customer link|
|R25        |e0/2|10.0.2.25/30 |-   |R25 e0/2 – e0/2 R26|Connectivity      |
|R25        |e0/3|52.0.1.34/30 |-   |R25 e0/3 – e0/1 R28|BGP: Customer link|
|R25   |-|172.16.2.25/32 |-   |-|Loopback                                  |
|R26        |e0/0|10.0.3.26/29 |-   |R26 e0/0 – e0/1 R24|Connectivity      |
|R26        |e0/1|52.0.1.29/30 |-   |R26 e0/1 – e0/0 R28|BGP: Customer link|
|R26        |e0/2|10.0.2.26/30 |-   |R26 e0/2 – e0/2 R25|Connectivity      |
|R26        |e0/3|52.0.1.26/30 |-   |R26 e0/3 – e0/3 R18|BGP: Customer link|
|R26   |-|172.16.2.26/32 |-   |-|Loopback                                  |


### Лабынтаги (нет номера AS)

Какой-то офис.

|Device|Port|IPv4      |VLAN|Link              |Comment           |
|------|----|----------|----|------------------|------------------|
|R27        |e0/0|52.0.1.38/30 |-   |R27 e0/0 – e0/1 R25|Default|
|R27   |-|172.16.2.27/32 |-   |-|Loopback                               |


### Чокурдах (нет номера AS)

Небольшой творческий офис. Пристанище для дизайнера и фрилансера.

|Device|Port|IPv4      |VLAN|Link              |Comment           |
|------|----|----------|----|------------------|------------------|
|R28        |e0/0|52.0.1.30/30 |-   |R28 e0/0 – e0/1 R26|BGP: Provider link|
|R28        |e0/1|52.0.1.33/30 |-   |R28 e0/1 – e0/3 R25|BGP: Provider link|
|R28        |e0/2.300|10.2.0.28/25  |300|R28 e0/2 – e0/2 SW29  |Default GW for Freelance|      |
|R28        |e0/2.310|10.2.1.28/25   |310|R28 e0/2 – e0/2 SW29   |Default GW for Designer|      |
|R28   |-|172.16.2.28/32 |-   |-|Loopback                               |
|SW29       |    |172.16.0.29/28|1000|-                 |Management        |
|SW29       |    |          |300 |-                 |Freelance (VLAN)  |
|SW29       |    |          |310 |-                 |Designer (VLAN)   |
|VPC30      |eth0|10.2.0.30/25  |300 |VPC30 eth0 – e0/0 SW29|                  |
|VPC31      |eth0|10.2.1.31/25  |310 |VPC31 eth0 – e0/1 SW29|                  |


## Итоговая схема

![ip_design.png](https://github.com/sneim/otus-network-engineer/blob/main/labs/lab01/scheme.jpg)






### Заметки:



[все тот же СДСМ](https://linkmeup.ru/blog/1188/)

</details>
